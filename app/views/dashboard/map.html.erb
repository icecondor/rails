<% content_for :header do %>
  <script src="//maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
<% end %>

<script>
  $('.topbar .nav #livemap').addClass('active')
</script>

<!-- initial data -->
<script>
var initial_locations = <%=raw @locations.to_json %>;
var group = <%=raw @group.to_json %>;
$(function() {
  mapstart();
  define_group_ui();
  play_initial_locations();
  setup_followers();
});
</script>

<div class="mapfloatheading">
  <div class="mapfloatcontent">
    <p id="subtitle">
      Continuous location tracking for Android phones.
    </p>

    <%= flash[:notice] %>

    <p id="publicupdates">
      <span id="titlelist">Recent Public Updates</span>
    <table id="trackedlist">
      <tr><td></td><td>Username</td><td>Last report</td></tr>
    </table>
    </p>
  </div>
</div>


<!-- Google Maps -->
<div id="map_canvas" style="width: 100%; height: 500px; margin-left:auto; margin-right: auto"></div>

<script id="trackedUserTemplate" type="text/x-jquery-tmpl">
  <tr>
    <td><img class="markerprofile" src="{{=ImageUrl}}" /></td>
    <td><a href="/{{=UserName}}">{{=UserName}}</a></td>
    <td id='{{=UserName}}-date'>{{=TimeAgo}} </td>
  </tr>
</script>